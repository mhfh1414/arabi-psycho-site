# -*- coding: utf-8 -*-
"""
اختبارات نفسية (نماذج أساسية)
"""

from typing import Dict, List, Any

# قاعدة بيانات مصغّرة للاختبارات
PSYCH_TESTS: Dict[str, Dict[str, Any]] = {
    "gad7": {
        "name": "مقياس القلق العام (GAD-7)",
        "items": [
            {"id": 1, "text": "كم مرة شعرت بالتوتر أو القلق أو العصبية؟"},
            {"id": 2, "text": "كم مرة لم تستطع إيقاف القلق أو السيطرة عليه؟"},
            {"id": 3, "text": "كم مرة كنت قلقًا أكثر من اللازم بشأن أمور مختلفة؟"},
            {"id": 4, "text": "كم مرة واجهت صعوبة في الاسترخاء؟"},
            {"id": 5, "text": "كم مرة كنت قلقًا لدرجة يصعب عليك الجلوس ساكنًا؟"},
            {"id": 6, "text": "كم مرة شعرت بسهولة الانزعاج أو التهيج؟"},
            {"id": 7, "text": "كم مرة شعرت بالخوف وكأن شيئًا سيئًا قد يحدث؟"},
        ],
        "scale": [0, 1, 2, 3],
        "labels": ["أبدًا", "عدة أيام", "أكثر من نصف الأيام", "تقريبًا يوميًا"],
    },
    "phq9": {
        "name": "مقياس الاكتئاب (PHQ-9)",
        "items": [
            {"id": 1, "text": "قلة الاهتمام أو المتعة في ممارسة الأنشطة"},
            {"id": 2, "text": "الشعور بالإحباط أو الاكتئاب أو اليأس"},
            {"id": 3, "text": "صعوبة النوم أو النوم بشكل زائد"},
            {"id": 4, "text": "الشعور بالتعب أو قلة الطاقة"},
            {"id": 5, "text": "ضعف الشهية أو الإفراط في الأكل"},
            {"id": 6, "text": "الشعور السيء تجاه نفسك أو أنك فاشل"},
            {"id": 7, "text": "صعوبة التركيز على المهام"},
            {"id": 8, "text": "بطء أو فرط في الحركة بشكل ملحوظ"},
            {"id": 9, "text": "أفكار بأنك قد تكون أفضل حالًا لو كنت ميتًا أو بإيذاء نفسك"},
        ],
        "scale": [0, 1, 2, 3],
        "labels": ["أبدًا", "عدة أيام", "أكثر من نصف الأيام", "تقريبًا يوميًا"],
    },
}


# ------------------ دوال مساعدة ------------------

def score_test(test_key: str, answers: Dict[int, int]) -> Dict[str, Any]:
    """إرجاع مجموع الدرجات"""
    test = PSYCH_TESTS.get(test_key)
    if not test:
        return {"total": 0, "details": {}}

    total = sum(answers.values())
    return {"total": total, "details": answers}


def get_scale_options(test_key: str) -> List[int]:
    """إرجاع خيارات الاستجابة الافتراضية"""
    test = PSYCH_TESTS.get(test_key)
    if test:
        return test.get("scale", [0, 1, 2, 3])
    return [0, 1, 2, 3]


# اختبار محلي سريع
if __name__ == "__main__":
    dummy = {i: 2 for i in range(1, 8)}
    print("GAD7:", score_test("gad7", dummy))
    print("خيارات:", get_scale_options("gad7"))
